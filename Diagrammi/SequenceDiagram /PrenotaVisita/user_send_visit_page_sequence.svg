<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1058px" preserveAspectRatio="none" style="width:926px;height:1058px;background:#FFFFFF;" version="1.1" viewBox="0 0 926 1058" width="926px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="617.3906" style="stroke:#000000;stroke-width:1.5;" width="899.5" x="10" y="343.2266"/><rect fill="none" height="424.5938" style="stroke:#000000;stroke-width:1.5;" width="879.5" x="20" y="529.0234"/><rect fill="none" height="264.0625" style="stroke:#000000;stroke-width:1.5;" width="859.5" x="30" y="682.5547"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="66" x2="66" y1="81.2969" y2="977.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="261" x2="261" y1="81.2969" y2="977.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="500.5" x2="500.5" y1="81.2969" y2="977.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="629.5" x2="629.5" y1="81.2969" y2="977.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="765.5" x2="765.5" y1="81.2969" y2="977.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="850.5" x2="850.5" y1="81.2969" y2="977.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="40" y="77.9951">Utente</text><ellipse cx="66.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M66.5,21.5 L66.5,48.5 M53.5,29.5 L79.5,29.5 M66.5,48.5 L53.5,63.5 M66.5,48.5 L79.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="40" y="989.6123">Utente</text><ellipse cx="66.5" cy="1001.4141" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M66.5,1009.4141 L66.5,1036.4141 M53.5,1017.4141 L79.5,1017.4141 M66.5,1036.4141 L53.5,1051.4141 M66.5,1036.4141 L79.5,1051.4141 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="185" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="192" y="69.9951">UserSendVisitsPage</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="185" y="976.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="192" y="996.6123">UserSendVisitsPage</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="449.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="456.5" y="69.9951">AuthProvider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="449.5" y="976.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="456.5" y="996.6123">AuthProvider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="561.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="568.5" y="69.9951">VisitaRepositories</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="561.5" y="976.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="568.5" y="996.6123">VisitaRepositories</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="719.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="726.5" y="69.9951">HttpService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="719.5" y="976.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="726.5" y="996.6123">HttpService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="822.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="829.5" y="69.9951">Dialog</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="822.5" y="976.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="829.5" y="996.6123">Dialog</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="919.5" x="0" y="111.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="919.5" y1="111.8633" y2="111.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="919.5" y1="114.8633" y2="114.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="174" x="372.75" y="101.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="155" x="378.75" y="117.3638">Selezione Data e Ora</text><polygon fill="#181818" points="249.5,151.5625,259.5,155.5625,249.5,159.5625,253.5,155.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="66.5" x2="255.5" y1="155.5625" y2="155.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="73.5" y="150.4966">Seleziona data e ora</text><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="303.5" y1="184.6953" y2="184.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="303.5" x2="303.5" y1="184.6953" y2="197.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="262.5" x2="303.5" y1="197.6953" y2="197.6953"/><polygon fill="#181818" points="272.5,193.6953,262.5,197.6953,272.5,201.6953,268.5,197.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="268.5" y="179.6294">Salva _selectedDay, _selectedTime</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="919.5" x="0" y="226.2617"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="919.5" y1="226.2617" y2="226.2617"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="919.5" y1="229.2617" y2="229.2617"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="171" x="374.25" y="215.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="380.25" y="231.7622">Invio Richiesta Visita</text><polygon fill="#181818" points="249.5,265.9609,259.5,269.9609,249.5,273.9609,253.5,269.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="66.5" x2="255.5" y1="269.9609" y2="269.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="73.5" y="264.895">Premere "Conferma Visita"</text><polygon fill="#181818" points="488.5,295.0938,498.5,299.0938,488.5,303.0938,492.5,299.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="494.5" y1="299.0938" y2="299.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="268.5" y="294.0278">currentUser</text><polygon fill="#181818" points="272.5,324.2266,262.5,328.2266,272.5,332.2266,268.5,328.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="266.5" x2="499.5" y1="328.2266" y2="328.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="278.5" y="323.1606">username</text><path d="M10,343.2266 L74,343.2266 L74,350.3594 L64,360.3594 L10,360.3594 L10,343.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="617.3906" style="stroke:#000000;stroke-width:1.5;" width="899.5" x="10" y="343.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="356.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="191" x="89" y="355.437">[Se data/ora non selezionate]</text><polygon fill="#181818" points="839,377.4922,849,381.4922,839,385.4922,843,381.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="845" y1="381.4922" y2="381.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="268.5" y="376.4263">Mostra "Errore"</text><polygon fill="#181818" points="77.5,391.4922,67.5,395.4922,77.5,399.4922,73.5,395.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="71.5" x2="850" y1="395.4922" y2="395.4922"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="909.5" y1="404.4922" y2="404.4922"/><polygon fill="#181818" points="618,422.625,628,426.625,618,430.625,622,426.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="624" y1="426.625" y2="426.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="268.5" y="421.5591">getVisiteByUsername(username)</text><polygon fill="#181818" points="754,451.7578,764,455.7578,754,459.7578,758,455.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="630" x2="760" y1="455.7578" y2="455.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="637" y="450.6919">GET /visite/utente</text><polygon fill="#181818" points="641,480.8906,631,484.8906,641,488.8906,637,484.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="635" x2="765" y1="484.8906" y2="484.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="647" y="479.8247">Lista visite</text><polygon fill="#181818" points="272.5,510.0234,262.5,514.0234,272.5,518.0234,268.5,514.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="266.5" x2="629" y1="514.0234" y2="514.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="278.5" y="508.9575">Lista visite</text><path d="M20,529.0234 L84,529.0234 L84,536.1563 L74,546.1563 L20,546.1563 L20,529.0234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="424.5938" style="stroke:#000000;stroke-width:1.5;" width="879.5" x="20" y="529.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="542.0903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="298" x="99" y="541.2339">[Esiste visita in attesa per lo stesso immobile]</text><polygon fill="#181818" points="839,563.2891,849,567.2891,839,571.2891,843,567.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="845" y1="567.2891" y2="567.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="268.5" y="562.2231">Mostra "Hai già una visita in attesa"</text><polygon fill="#181818" points="77.5,577.2891,67.5,581.2891,77.5,585.2891,73.5,581.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="71.5" x2="850" y1="581.2891" y2="581.2891"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="899.5" y1="590.2891" y2="590.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="303.5" y1="612.4219" y2="612.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="303.5" x2="303.5" y1="612.4219" y2="625.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="262.5" x2="303.5" y1="625.4219" y2="625.4219"/><polygon fill="#181818" points="272.5,621.4219,262.5,625.4219,272.5,629.4219,268.5,625.4219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="268.5" y="607.356">Costruisce visitaDateTime</text><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="303.5" y1="654.5547" y2="654.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="303.5" x2="303.5" y1="654.5547" y2="667.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="262.5" x2="303.5" y1="667.5547" y2="667.5547"/><polygon fill="#181818" points="272.5,663.5547,262.5,667.5547,272.5,671.5547,268.5,667.5547" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="268.5" y="649.4888">Verifica se orario è occupato</text><path d="M30,682.5547 L94,682.5547 L94,689.6875 L84,699.6875 L30,699.6875 L30,682.5547 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="264.0625" style="stroke:#000000;stroke-width:1.5;" width="859.5" x="30" y="682.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="695.6216">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="113" x="109" y="694.7651">[Orario occupato]</text><polygon fill="#181818" points="839,716.8203,849,720.8203,839,724.8203,843,720.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="845" y1="720.8203" y2="720.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="268.5" y="715.7544">Mostra "Orario già occupato"</text><polygon fill="#181818" points="77.5,730.8203,67.5,734.8203,77.5,738.8203,73.5,734.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="71.5" x2="850" y1="734.8203" y2="734.8203"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="889.5" y1="743.8203" y2="743.8203"/><polygon fill="#181818" points="618,761.9531,628,765.9531,618,769.9531,622,765.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="624" y1="765.9531" y2="765.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="268.5" y="760.8872">createVisita(visita)</text><polygon fill="#181818" points="754,791.0859,764,795.0859,754,799.0859,758,795.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="630" x2="760" y1="795.0859" y2="795.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="637" y="790.02">POST /visite</text><polygon fill="#181818" points="641,820.2188,631,824.2188,641,828.2188,637,824.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="635" x2="765" y1="824.2188" y2="824.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="647" y="819.1528">OK</text><polygon fill="#181818" points="272.5,849.3516,262.5,853.3516,272.5,857.3516,268.5,853.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="266.5" x2="629" y1="853.3516" y2="853.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="278.5" y="848.2856">"Successo"</text><polygon fill="#181818" points="839,878.4844,849,882.4844,839,886.4844,843,882.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="845" y1="882.4844" y2="882.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="268.5" y="877.4185">Mostra "Successo"</text><polygon fill="#181818" points="77.5,892.4844,67.5,896.4844,77.5,900.4844,73.5,896.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="71.5" x2="850" y1="896.4844" y2="896.4844"/><line style="stroke:#181818;stroke-width:1.0;" x1="261.5" x2="303.5" y1="925.6172" y2="925.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="303.5" x2="303.5" y1="925.6172" y2="938.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="262.5" x2="303.5" y1="938.6172" y2="938.6172"/><polygon fill="#181818" points="272.5,934.6172,262.5,938.6172,272.5,942.6172,268.5,938.6172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="268.5" y="920.5513">Reset stato UI</text><!--MD5=[8fd20c9417beb243a4aa267fa0860978]
@startuml
actor Utente
participant UserSendVisitsPage
participant AuthProvider
participant VisitaRepositories
participant HttpService
participant Dialog as CupertinoDialog

== Selezione Data e Ora ==
Utente -> UserSendVisitsPage : Seleziona data e ora
UserSendVisitsPage -> UserSendVisitsPage : Salva _selectedDay, _selectedTime

== Invio Richiesta Visita ==
Utente -> UserSendVisitsPage : Premere "Conferma Visita"
UserSendVisitsPage -> AuthProvider : currentUser
AuthProvider - -> UserSendVisitsPage : username

alt Se data/ora non selezionate
    UserSendVisitsPage -> CupertinoDialog : Mostra "Errore"
    CupertinoDialog - -> Utente
else

    UserSendVisitsPage -> VisitaRepositories : getVisiteByUsername(username)
    VisitaRepositories -> HttpService : GET /visite/utente
    HttpService - -> VisitaRepositories : Lista visite
    VisitaRepositories - -> UserSendVisitsPage : Lista visite

    alt Esiste visita in attesa per lo stesso immobile
        UserSendVisitsPage -> CupertinoDialog : Mostra "Hai già una visita in attesa"
        CupertinoDialog - -> Utente
    else

        UserSendVisitsPage -> UserSendVisitsPage : Costruisce visitaDateTime
        UserSendVisitsPage -> UserSendVisitsPage : Verifica se orario è occupato

        alt Orario occupato
            UserSendVisitsPage -> CupertinoDialog : Mostra "Orario già occupato"
            CupertinoDialog - -> Utente
        else
            UserSendVisitsPage -> VisitaRepositories : createVisita(visita)
            VisitaRepositories -> HttpService : POST /visite
            HttpService - -> VisitaRepositories : OK
            VisitaRepositories - -> UserSendVisitsPage : "Successo"

            UserSendVisitsPage -> CupertinoDialog : Mostra "Successo"
            CupertinoDialog - -> Utente
            UserSendVisitsPage -> UserSendVisitsPage : Reset stato UI

        end
    end
end
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>